from main import getData  

def test_getData(mocker):
    mock_data = [
  {
    "case_number": "223019981",
    "dhsmv_number": "26242196",
    "accident_date": "2023-12-19T08:49:58.000",
    "accident_hour_of_day": "8",
    "crash_minutes": "49",
    "accident_day_of_week": "Tuesday",
    "occurred_on": "US 441 (SW 13TH ST)",
    "intersecttype": "FOUR-WAY INTERSECTION",
    "at_from_intersection": "SR 222 (SW 16TH AVE)",
    "totalpeopleinvolved": "3",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "3",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "265494600",
    "geoy": "23796711",
    "longitude": "-82.32272",
    "latitude": "29.65198",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
  },
  {
    "case_number": "223000500",
    "dhsmv_number": "25597022",
    "accident_date": "2023-01-11T10:23:22.000",
    "accident_hour_of_day": "10",
    "crash_minutes": "23",
    "accident_day_of_week": "Wednesday",
    "occurred_on": "SR 121 (SW 34TH ST)",
    "intersecttype": "NOT AT INTERSECTION",
    "at": "30    FEET",
    "direction": "S",
    "at_from_intersection": "HULL RD",
    "totalpeopleinvolved": "3",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "3",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "264441775",
    "geoy": "23820608",
    "longitude": "-82.32272",
    "latitude": "29.65198",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000231",
    "dhsmv_number": "25596949",
    "accident_date": "2023-01-05T19:07:41.000",
    "accident_hour_of_day": "19",
    "crash_minutes": "7",
    "accident_day_of_week": "Thursday",
    "occurred_on": "SE 15TH ST",
    "at_street_address": "1101",
    "intersecttype": "NOT AT INTERSECTION",
    "at": "FEET",
    "totalpeopleinvolved": "2",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "2",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "266555075",
    "geoy": "23981311",
    "longitude": "-82.30588",
    "latitude": "29.64088",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000346",
    "dhsmv_number": "25596962",
    "accident_date": "2023-01-07T23:08:28.000",
    "accident_hour_of_day": "23",
    "crash_minutes": "8",
    "accident_day_of_week": "Saturday",
    "occurred_on": "SW 10TH STREET",
    "intersecttype": "OTHER (EXPLAIN IN NARRATIVE)",
    "at": "5     FEET",
    "direction": "S",
    "at_from_intersection": "SR 26 (WEST UNIVERISTY AVE)",
    "totalpeopleinvolved": "3",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "2",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "265621200",
    "geoy": "24366489",
    "longitude": "-82.32272",
    "latitude": "29.65198",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000223",
    "dhsmv_number": "25596993",
    "accident_date": "2023-01-05T17:03:03.000",
    "accident_hour_of_day": "17",
    "crash_minutes": "3",
    "accident_day_of_week": "Thursday",
    "occurred_on": "S MAIN ST",
    "at_street_address": "1609",
    "intersecttype": "NOT AT INTERSECTION",
    "totalpeopleinvolved": "1",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "3",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "265875150",
    "geoy": "23792953",
    "longitude": "-82.32446",
    "latitude": "29.66716",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000375",
    "dhsmv_number": "25596971",
    "accident_date": "2023-01-08T17:43:07.000",
    "accident_hour_of_day": "17",
    "crash_minutes": "43",
    "accident_day_of_week": "Sunday",
    "occurred_on": "SR 26 (W UNIVERSITY AVE)",
    "intersecttype": "NOT AT INTERSECTION",
    "at": "10    FEET",
    "direction": "W",
    "at_from_intersection": "SR 121 (SW 34TH ST)",
    "totalpeopleinvolved": "2",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "2",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "264430450",
    "geoy": "24340258",
    "longitude": "-82.32272",
    "latitude": "29.65198",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000480",
    "dhsmv_number": "25596992",
    "accident_date": "2023-01-10T19:25:08.000",
    "accident_hour_of_day": "19",
    "crash_minutes": "25",
    "accident_day_of_week": "Tuesday",
    "occurred_on": "SR-121 (SW WILLISTON RD)",
    "intersecttype": "T-INTERSECTION",
    "at": "10    FEET",
    "direction": "E",
    "at_from_intersection": "I-75 NORTHBOUND ON RAMP",
    "totalpeopleinvolved": "2",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "2",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "264467950",
    "geoy": "22561378",
    "longitude": "-82.32272",
    "latitude": "29.65198",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000340",
    "dhsmv_number": "25596958",
    "accident_date": "2023-01-07T21:08:29.000",
    "accident_hour_of_day": "21",
    "crash_minutes": "8",
    "accident_day_of_week": "Saturday",
    "occurred_on": "SR-331 (SW WILLISTON RD)",
    "at_street_address": "2800",
    "intersecttype": "NOT AT INTERSECTION",
    "totalpeopleinvolved": "3",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "2",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "264736225",
    "geoy": "22790811",
    "longitude": "-82.36419",
    "latitude": "29.60872",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000470",
    "dhsmv_number": "25596997",
    "accident_date": "2023-01-10T17:25:44.000",
    "accident_hour_of_day": "17",
    "crash_minutes": "25",
    "accident_day_of_week": "Tuesday",
    "occurred_on": "(W NEWBERRY RD) P. GARAGE",
    "at_street_address": "6420",
    "intersecttype": "OTHER (EXPLAIN IN NARRATIVE)",
    "direction": "N",
    "totalpeopleinvolved": "1",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "2",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "263206400",
    "geoy": "24601291",
    "longitude": "-82.41051",
    "latitude": "29.65969",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000212",
    "dhsmv_number": "25596947",
    "accident_date": "2023-01-05T12:47:29.000",
    "accident_hour_of_day": "12",
    "crash_minutes": "47",
    "accident_day_of_week": "Thursday",
    "occurred_on": "CR 2053 (NW 43RD ST)",
    "intersecttype": "FOUR-WAY INTERSECTION",
    "at": "40    FEET",
    "direction": "N",
    "at_from_intersection": "CR 232 (NW 53RD AVE)",
    "totalpeopleinvolved": "3",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "3",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "263876225",
    "geoy": "26196291",
    "longitude": "-82.32272",
    "latitude": "29.65198",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000473",
    "dhsmv_number": "25596998",
    "accident_date": "2023-01-10T18:15:04.000",
    "accident_hour_of_day": "18",
    "crash_minutes": "15",
    "accident_day_of_week": "Tuesday",
    "occurred_on": "NW 13TH STREET (US 441)",
    "at_street_address": "2100",
    "intersecttype": "NOT AT INTERSECTION",
    "direction": "N",
    "totalpeopleinvolved": "6",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "2",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "265466800",
    "geoy": "25090586",
    "longitude": "-82.33922",
    "latitude": "29.65565",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  },
  {
    "case_number": "223000419",
    "dhsmv_number": "25596982",
    "accident_date": "2023-01-09T18:20:52.000",
    "accident_hour_of_day": "18",
    "crash_minutes": "20",
    "accident_day_of_week": "Monday",
    "occurred_on": "US 441 (SW 13TH ST)",
    "at_street_address": "2701",
    "intersecttype": "NOT AT INTERSECTION",
    "totalpeopleinvolved": "2",
    "numberofbicyclesinvolved": "0",
    "numberofpedestriansinvolved": "0",
    "totalvehiclesinvolved": "4",
    "numberofmopedsinvolved": "0",
    "numberofmotorcylesinvolved": "0",
    "numberofbusesinvolved": "0",
    "totalfatalities": "0",
    "geox": "265501825",
    "geoy": "23432080",
    "longitude": "-82.33927",
    "latitude": "29.64796",
    "location": {
      "type": "Point",
      "coordinates": [-82.32272, 29.65198]
    },
    "city": "Gainesville",
    "state": "Florida",
    ":@computed_region_ecgy_hwrz": "1",
    ":@computed_region_e6r8_dw75": "13",
    ":@computed_region_u9vc_vmbc": "1",
    ":@computed_region_4rat_gsiv": "772",
    ":@computed_region_axii_i744": "4"
  }
]
    
    # Mock the Socrata client response
    mocker.patch("main.Socrata.get", return_value=mock_data)
    
    data = getData("iecn-3sxx", "accident_date", 2023, 1, 5)  
    assert isinstance(data, list)
    assert len(data) > 0
    assert "case_number" in data[0]
    assert "totalpeopleinvolved" in data[0]

